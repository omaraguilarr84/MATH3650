% Omar Aguilar

function [x,l] = InvPowerMethod(A, x0, tolerance)

xold=x0;

l = x' * (A*x) / (x'*x);
lold = l+1;

itcount = 0;

while abs(l-lold)>tolerance

    itcount = itcount + 1;
    if itcount > 100
        error('iterations exceeded 100');
    end
    y = inv(A)*xold;
    x = y / norm(y,inf);

    lold = l;
    l = x' * (A*x) / (x'*x);
end

end